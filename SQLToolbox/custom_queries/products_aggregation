with layer1 as (
	select
		split(website_ids,',') as website_ids_split,
  		product_id,
		product_sku,
  		product_name,
		is_product_active,
	    surtype,
    	type,
	    manufacturer,
    	brand,
  		is_brand_active
  	from
		`reporting-boryl-lcda.analysis.analysis_products`
),

layer2 as (
  select
      product_id,
      product_sku,
      product_name,
      is_product_active,
      surtype,
      type,
      manufacturer,
      brand,
 	  is_brand_active,
      unique_website_id
  from
      layer1,
      unnest(website_ids_split) as unique_website_id
)

select
	*
from
	layer2
where
	unique_website_id in unnest(@unique_website_ids)
