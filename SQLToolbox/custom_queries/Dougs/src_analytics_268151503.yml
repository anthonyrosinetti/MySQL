version: 2

sources:
  - name: analytics_268151503
    description: Raw data from Google Analytics 4 sent by native Google Analytics 4 raw data export within BigQuery
    database: data-production-398108
    schema: analytics_268151503
    config:
      freshness:
        warn_after: { count: 24, period: hour }
        error_after: { count: 48, period: hour }
        loaded_at_field: TIMESTAMP_MICROS(event_timestamp)

    tables:
      - name: events
        identifier: events_*
        description: Raw data from Google Analytics 4 native data export to BigQuery. Detailed table schema from Google available here https://support.google.com/analytics/answer/7029846
        columns:
          - name: event_timestamp
            description: The time (in microseconds, UTC) when the event was received by Google Analytics (required)
            tests:
              - not_null
          - name: user_pseudo_id
            description: GA Client ID (visitor ID) - null when not consented
          - name: event_name
            description: The name of the event (required)
            tests:
              - not_null
          - name: event_params
            description: Contextual event parameters, as a repeated record. Sub-columns of the record being 'key' for the name of the event parameters, and 'value', which is a record  containing the event parameters's value in different sub-columns depending on the type of the data
          - name: collected_traffic_source
            description: Traffic source data that was present within the events that were collected, as nullable record
          - name: session_traffic_source_last_click
            description: Last-click attributed session traffic source data across Google ads and manual contexts, where available, as nullable record

models:
  - name: stg_google_analytics_4_events
    description: Raw data from Google Analytics 4 native data export to BigQuery
    columns:
      - name: table_suffix_date
        description: The date of the table partition (_TABLE_SUFFIX) the data was loaded in BigQuery in ; usually the event date (required)
        tests:
          - not_null
      - name: event_timestamp
        description: The time (in microseconds, UTC) when the event was received by Google Analytics (required)
        tests:
          - not_null
      - name: user_pseudo_id
        description: GA Client ID (visitor ID) - null when not consented
      - name: event_name
        description: The name of the event (required)
        tests:
          - not_null
      - name: event_params
        description: Contextual event parameters, as a repeated record. Sub-columns of the record being 'key' for the name of the event parameters, and 'value', which is a record  containing the event parameters's value in different sub-columns depending on the type of the data
      - name: collected_traffic_source
        description: Traffic source data that was present within the events that were collected, as nullable record
      - name: session_traffic_source_last_click
        description: Last-click attributed session traffic source data across Google ads and manual contexts, where available, as nullable record
