version: 2

sources:
  - name: bronze_airbyte_facebook_ads
    description: Raw data from Meta Ads (including Facebook, Instagram, Whatsapp as well as Audience Network) sent via Airbyte within BigQuery
    database: data-production-398108
    schema: bronze_airbyte_facebook_ads
    config:
      freshness:
        warn_after: { count: 24, period: hour }
        error_after: { count: 48, period: hour }
    loaded_at_field: _airbyte_extracted_at

    tables:
      - name: campaigns
        description: Attributes of the Meta Ads campaigns
        columns:
          - name: account_id
            description: Identifier of the account which contains campaigns (required)
            tests:
              - not_null
          - name: id
            description: Identifier of the campaign (required)
            tests:
              - not_null
          - name: name
            description: Name of the campaign
      - name: ad_sets
        description: Attributes of the Meta Ads adsets
        columns:
          - name: account_id
            description: Identifier of the account which contains adsets (required)
            tests:
              - not_null
          - name: id
            description: Identifier of the adset (required)
            tests:
              - not_null
          - name: name
            description: Name of the adset
      - name: ads
        description: Attributes of the Meta Ads ads
        columns:
          - name: account_id
            description: Identifier of the account which contains ads (required)
            tests:
              - not_null
          - name: id
            description: Identifier of the ad (required)
            tests:
              - not_null
          - name: name
            description: Name of the ad
      - name: ads_insights
        description: Daily insights from Meta Ads. For basic insight at the ad granularity. For action insight at the ad, action type, action destination and action target id granularity
        columns:
          - name: date_start
            description: Date of the statistics (required)
            tests:
              - not_null
          - name: account_id
            description: Identifier of the account which contains the ad (required)
            tests:
              - not_null
          - name: campaign_id
            description: Identifier of the campaign (required)
            tests:
              - not_null
          - name: adset_id
            description: Identifier of the adset (required)
            tests:
              - not_null
          - name: ad_id
            description: Identifier of the ad (required)
            tests:
              - not_null
          - name: impressions
            description: Volume of impressions on the specific ad and day
          - name: clicks
            description: Volume of clicks on the specific ad and day
          - name: spend
            description: Budget spent on the specific ad and day, in the account currency (EUR for Dougs)

models:
  - name: stg_meta_ads_ads
    description: Attributes of the Meta Ads ads
    columns:
      - name: timestamp_last_refresh
        description: Timestamp at which the data was refreshed (required)
        tests:
          - not_null
      - name: account_id
        description: Identifier of the account which contains the ad (required)
        tests:
          - not_null
      - name: ad_id
        description: Identifier of the ad (required)
        tests:
          - not_null
      - name: ad_name
        description: Name of the ad

  - name: stg_meta_ads_ads_insights
    description: Daily insights from Meta Ads. For basic insight at the ad granularity. For action insight at the ad, action type, action destination and action target id granularity
    columns:
      - name: timestamp_last_refresh
        description: Timestamp at which the data was refreshed (required)
        tests:
          - not_null
      - name: date_report
        description: Date of the statistics (required)
        tests:
          - not_null
      - name: account_id
        description: Identifier of the account which contains the ad (required)
        tests:
          - not_null
      - name: campaign_id
        description: Identifier of the campaign (required)
        tests:
          - not_null
      - name: adset_id
        description: Identifier of the adset (required)
        tests:
          - not_null
      - name: ad_id
        description: Identifier of the ad (required)
        tests:
          - not_null
      - name: impressions
        description: Volume of impressions on the specific ad and day
      - name: clicks
        description: Volume of clicks on the specific ad and day
      - name: spend
        description: Budget spent on the specific ad and day, in the account currency (EUR for Dougs)

  - name: stg_meta_ads_ad_sets
    description: Attributes of the Meta Ads adsets
    columns:
      - name: timestamp_last_refresh
        description: Timestamp at which the data was refreshed (required)
        tests:
          - not_null
      - name: account_id
        description: Identifier of the account which contains the adset (required)
        tests:
          - not_null
      - name: adset_id
        description: Identifier of the adset (required)
        tests:
          - not_null
      - name: adset_name
        description: Name of the adset

  - name: stg_meta_ads_campaigns
    description: Attributes of the Meta Ads campaigns
    columns:
      - name: timestamp_last_refresh
        description: Timestamp at which the data was refreshed (required)
        tests:
          - not_null
      - name: account_id
        description: Identifier of the account which contains the campaign (required)
        tests:
          - not_null
      - name: campaign_id
        description: Identifier of the campaign (required)
        tests:
          - not_null
      - name: campaign_name
        description: Name of the campaign

  - name: stg_meta_ads_conversion_stats
    description: Conversion stats of the Meta Ads campaigns
    columns:
      - name: date_report
        description: Data at which the conversion data was recorded
        tests:
          - not_null
      - name: account_id
        description: Identifier of the account which contains the campaign (required)
        tests:
          - not_null
      - name: campaign_id
        description: Identifier of the campaign (required)
        tests:
          - not_null
      - name: actions
        description: Volume of actions
      - name: conversions
        description: Volume of conversions        
